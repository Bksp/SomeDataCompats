name: Publicar automáticamente ZIP al confirmar

on:
  push:
    branches: [ main ]

jobs:
  build_and_publish:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Instalar herramienta de creación de ZIP (si es necesario)
        run: sudo apt-get update && sudo apt-get install -y zip

      - name: Crear archivo ZIP
        run: zip -qr ${{ github.sha }}.zip ./data ./pack.mcmeta

      - uses: actions/upload-artifact@v3
        with:
          name: ${{ github.sha }}.zip
          path: ${{ github.sha }}.zip

      - uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.API_TOKEN2 }}
        with:
          tag_name: ${{ github.sha }}
          release_name: "Versión ${{ github.sha }}"
          draft: false
          prerelease: false

